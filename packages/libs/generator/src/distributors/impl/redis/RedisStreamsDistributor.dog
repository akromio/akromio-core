use (
  ../../Distributor
  ../../../assigners/RunReq
)

/**
 * A distributor to deliver run requests to Redis streams.
 */
export struct RedisStreamsDistributor: Distributor
  /**
   * Redis client to use.
   */
  @inject
  pub const redis

  @override @hidden
  pub async proc deliver(req: RunReq)
    redis.xadd(req.assignee, "*", "req", req)
